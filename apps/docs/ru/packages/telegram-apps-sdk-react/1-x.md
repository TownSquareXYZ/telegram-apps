---
outline:
  - 2
  - 3
---

# @telegram-apps/sdk-react

<p style="display: inline-flex; gap: 8px">
  <a href="https://npmjs.com/package/@telegram-apps/sdk-react">
    <img src="https://img.shields.io/npm/v/@telegram-apps/sdk-react?logo=npm"/>
  </a>
  <img src="https://img.shields.io/bundlephobia/minzip/@telegram-apps/sdk-react"/>
  <a href="https://github.com/Telegram-Mini-Apps/telegram-apps/tree/master/packages/sdk-react">
    <img src="https://img.shields.io/badge/source-black?logo=github"/>
  </a>
</p>

Хуки Включает хуки, компоненты и
утилиты для комфортного использования React JS на платформе мини-приложений Telegram.

## Установка

Прежде всего, предполагается, что вы уже установили пакет `react`, поскольку он является зависимым от этого пакета.

::: code-group

```bash [pnpm]
pnpm i @telegram-apps/sdk-react
```

```bash [npm]
npm i @telegram-apps/sdk-react
```

```bash [yarn]
yarn add @telegram-apps/sdk-react
```

:::

## SDKProvider

`SDKProvider` - это компонент, который отвечает за предоставление функциональности SDK. Он принимает такие свойства, как `acceptCustomStyles: boolean` и `debug: boolean`. Оба они являются необязательными.

Свойство `acceptCustomStyles` отвечает за принятие пользовательских стилей из веб-версии Telegram.

Свойство `debug` отвечает за включение режима отладки.

```jsx
import { SDKProvider } from '@telegram-apps/sdk-react';

/**
 * Корневой компонент для всего проекта.
 */
export function Root() {
  return (
    <SDKProvider acceptCustomStyles debug>
      <div>My application!</div>
    </SDKProvider>
  );
}
```

## Хоки

Для лучшего понимания, каждый хук компонента использует собственную функцию инициализации, связанную с компонентом. Если функция инициализации возвращает не промисное значение, хук немедленно его получает. Если функция инициализации асинхронная, хук вернет `undefined` значение, пока компонент все еще инициализируется. Затем он будет обновлен до инициализированного значения.

Все хуки компонентов в этом пакете разделены на две части:

1. Получение фактического значения функции инициализации. Эти хуки не имеют суффикса, например `useBackButton`.
2. Извлечение метаэлемента, связанного со значением функции инициализации. Эти хуки включают суффикс, как `Raw`, например `useBackButtonRaw`.

Первая категория хуков возвращает фактическое значение функции инициализации. Они выдают ошибку, если что-то идет не так во время инициализации компонента.

Вторая категория хуков возвращает объект, содержащий информацию о процессе инициализации.
Вот форма объекта:

```ts
export interface SDKContextItem<T> {
  /**
   * Результат выполнения этого элемента. Свойство может отсутствовать
   * в случае асинхронного выполнения.
   */
  result?: T;
  /**
   * Функция для очистки эффектов элемента.
   */
  cleanup?(): void;
  /**
   * Во время выполнения произошла ошибка.
   */
  error?: unknown;
}
```

Используя вторую категорию хуков, можно извлечь ошибку, не выбрасывая ее.

Вот полный пример использования:

```ts
import {
  useBackButton,
  useBackButtonRaw,
  useViewport,
  useViewportRaw,
  useBiometryManagerRaw,
} from '@telegram-apps/sdk-react';
import { useEffect } from 'react';

// BackButton инициализируется синхронно. Итак, bb будет 
// экземпляром BackButton.
const bb = useBackButton();

// Область просмотра инициализируется асинхронно, поэтому сигнал может вернуть undefined.
// Через некоторое время он получит допустимое значение.
const vp = useViewport();

useEffect(() => {
  console.log(vp); // будет undefined, а затем экземпляром области просмотра.
}, [vp]);

const bm = useBiometryManagerRaw();

useEffect(() => {
  if (bm.error) {
    console.error('Something went wrong for BiometryManager', bm.error);
  }
}, [bm]);
```

### SSR

Этот пакет также поддерживает режим SSR, широко используемый в популярных фреймворках, таких как Next.js. При использовании хуков пакета на стороне сервера необходимо передать `true` в качестве первого аргумента. Это уведомляет хук о том, что режим серверного рендеринга активирован. Не указание этого значения и вызов хука на стороне сервера приведет к ошибке.

Режим на стороне сервера возвращает `undefined` для каждого хука компонента на стороне сервера, а также до монтирования
текущего компонента. Это необходимо для сохранения состояния между деревьями, отрендеренными на стороне сервера и клиента.

```ts
import { useBackButton } from '@telegram-apps/sdk-react';
import { useEffect } from 'react';

function Component() {
  const bb = useBackButton(true); // будет undefined или BackButton.

  useEffect(() => {
    if (bb) {
      // Здесь мы можем безопасно работать с BackButton.
    }
  }, [bb]);
}
```

### Хоки

Все компоненты высшего порядка пакета используют описанные ранее хуки. Использование довольно простое:

```ts
import { withBackButton } from '@telegram-apps/sdk-react';
import { useEffect } from 'react';

const A = withBackButton('bb', false, ({ bb }) => {
  useEffect(() => {
    bb.show();
  }, [bb]);
  return null;
});

const B = withBackButton('bb', true, ({ bb }) => {
  useEffect(() => {
    bb && bb.show();
  }, [bb]);
  return null;
});
```

Как первый аргумент вы должны передать значение, отвечающее за получение имени свойства компонента результатом хука. Второй аргумент - режим SSR (серверный рендеринг), который будет передан внутреннему использованному хуку.

## Список хуков и хоков

| Хук и Хок (Результат)                           | Хук и Хок (Исходные данные)               | Возвращаемое значение                                                                                       |
| ------------------------------------------------------------------ | ------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------- |
| `useBackButtonRaw`, `withBackButtonRaw`                            | `useBackButton`, `withBackButton`                            | [BackButton](../telegram-apps-sdk/1-x/components/back-button.md)                                            |
| `useBiometryManagerRaw`, `withBiometryManagerRaw`. | `useBiometryManager`, `withBiometryManager`. | [BiometryManager](../telegram-apps-sdk/1-x/components/biometry-manager.md) или `undefined`. |
| `useClosingBehaviorRaw`, `withClosingBehaviorRaw`                  | `useClosingBehavior`, `withClosingBehavior`                  | [ClosingBehavior](../telegram-apps-sdk/1-x/components/closing-behavior.md)                                  |
| `useCloudStorageRaw`, `withCloudStorageRaw`                        | `useCloudStorage`, `withCloudStorage`                        | [CloudStorage](../telegram-apps-sdk/1-x/components/cloud-storage.md)                                        |
| `useHapticFeedbackRaw`, `withHapticFeedbackRaw`.   | `useHapticFeedback`, `withHapticFeedback`.   | [HapticFeedback](../telegram-apps-sdk/1-x/components/haptic-feedback.md)                                    |
| `useInitDataRaw`, `withInitDataRaw`                                | `useInitData`, `withInitData`                                | [InitData](../telegram-apps-sdk/1-x/components/init-data.md)                                                |
| `useInvoiceRaw`, `withInvoiceRaw`                                  | `useInvoice`, `withInvoice`                                  | [Invoice](../telegram-apps-sdk/1-x/components/invoice.md)                                                   |
|                                                                    | `useLaunchParams`                                            | [Launch params](../telegram-apps-sdk/1-x/launch-parameters.md)                                              |
| `useMainButtonRaw`, `withMainButtonRaw`                            | `useMainButton`, `withMainButton`                            | [MainButton](../telegram-apps-sdk/1-x/components/main-button.md)                                            |
| `useMiniAppRaw`, `withMiniAppRaw`                                  | `useMiniApp`, `withMiniApp`                                  | [MiniApp](../telegram-apps-sdk/1-x/components/mini-app.md)                                                  |
| `usePopupRaw`, `withPopupRaw`                                      | `usePopup`, `withPopup`                                      | [Popup](../telegram-apps-sdk/1-x/components/popup.md)                                                       |
| `useQRScannerRaw`, `withQRScannerRaw`                              | `useQRScanner`, `withQRScanner`                              | [QRScanner](../telegram-apps-sdk/1-x/components/qr-scanner.md)                                              |
| `useSettingsButtonRaw`, `withSettingsButtonRaw`                    | `useSettingsButton`, `withSettingsButton`                    | [SettingsButton](../telegram-apps-sdk/1-x/components/settings-button.md)                                    |
| `useSwipeBehaviorRaw`, `withSwipeBehaviorRaw`.     | `useSwipeBehavior`, `withSwipeBehavior`.     | [SwipeBehavior](../telegram-apps-sdk/1-x/components/swipe-behavior.md)                                      |
| `useThemeParamsRaw`, `withThemeParamsRaw`                          | `useThemeParams`, `withThemeParams`                          | [ThemeParams](../telegram-apps-sdk/1-x/components/theme-params.md)                                          |
| `useUtilsRaw`, `withUtilsRaw`                                      | `useUtils`, `withUtils`                                      | [Utils](../telegram-apps-sdk/1-x/components/utils.md)                                                       |
| `useViewportRaw`, `withViewportRaw`                                | `useViewport`, `withViewport`                                | [Viewport](../telegram-apps-sdk/1-x/components/viewport.md) или `undefined`.                |

## Шаблон

Мы уже создали [шаблон](https://github.com/Telegram-Mini-Apps/reactjs-template) для React JS, который использует текущий пакет, поэтому вы можете его использовать.
