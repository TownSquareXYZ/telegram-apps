---
outline:
  - 2
  - 3
---

# `MiniApp`

Компонент, обеспечивающий общую функциональность мини-приложений Telegram, который не поддерживается другими системными компонентами.

## Инициализация

Чтобы инициализировать компонент, используйте функцию `initMiniApp`:

```typescript
import { initMiniApp } from '@telegram-apps/sdk';

const [miniApp] = initMiniApp();  
```

## Цвета

### Хедер

Разработчик может получать и обновлять цвета хедера и фона мини-приложения. Чтобы получить текущее значение
цвета хедера, разработчик может обратиться к свойству `headerColor` и обновить его с помощью метода
`setHeaderColor`:

```typescript
miniApp.setHeaderColor('secondary_bg_color');
// или начиная с версии 6.10:
miniApp.setHeaderColor('#aa1132');
```

### Фон

Помимо цвета хедера мини-приложения, разработчик также может изменять цвет фона:

```typescript
miniApp.setBgColor('#888311');
```

Цвет фона мини-приложения используется для определения того, имеет ли текущее мини-приложение темную палитру. Чтобы определить, является ли текущая палитра темной, разработчику следует использовать свойство `isDark`:

```typescript
console.log(miniApp.isDark); // false
```

## Запросы доступа

Начиная с версии Telegram Mini Apps 6.9, мини-приложения могут  запрашивать доступ к номеру телефона
и к записи текущего пользователя. Для этого разработчики могут использовать
методы `requestPhoneAccess` и `requestWriteAccess`:

```typescript
miniApp.requestPhoneAccess().then(() => {
  // done.
});

miniApp.requestWriteAccess().then(() => {
  // done.
});
```

Для запроса контактной информации (например, номер телефона), используйте метод `requestContact`:

```typescript
miniApp.requestContact().then(contact => {
  console.log(contact);
  // Output:
  // {
  //   authDate: Date(...),
  //   hash: '...',
  //   contact: {
  //     firstName: '...',
  //     phoneNumber: '+38291789233',
  //   },
  // };
});
```

## Режим инлайн

Мини-приложения можно запускать в режиме [inline](https://core.telegram.org/bots/inline). При запуске
мини-приложения в таком режиме, разработчик может использовать метод `switchInlineQuery`:

```typescript
miniApp.switchInlineQuery('Show me something', ['users', 'groups']);
```

При вызове этого метода приложение Telegram отправляет имя пользователя бота и указанный текст
в чат, выбранный пользователем. Список доступных чатов будет ограничен типами чатов, указанными во втором аргументе.

Чтобы проверить, запущено ли текущее мини-приложение в инлайн-режиме, разработчику нужно обратиться к
к свойству `isBotInline`:

```typescript
console.log(miniApp.isBotInline); // false
```

## Методы жизненного цикла

### `ready`

Сообщает приложению Telegram, что мини-приложение готово к отображению.

Рекомендуется вызывать этот метод как можно раньше, как только загрузятся все необходимые элементы интерфейса. После вызова этого метода, плейсхолдер скрывается, и отображается мини-приложение.

Если метод не вызван, плейсхолдер будет скрыт только после полной загрузки страницы.

```typescript
miniApp.ready();
```

### `close`

Закрывает мини-приложение.

```typescript
miniApp.close();
```

Если вы хотите свернуть приложение в нижнюю панель, но не закрывать его, используйте первый аргумент `returnBack: boolean`.

```ts
// Свернет приложение в нижнюю панель.
miniApp.close(true);
```

## Другие методы

### `sendData`

Метод, используемый для отправки данных боту. При вызове этого метода боту
отправляется служебное сообщение, содержащее данные длиной до 4096 байт, после чего мини-приложение закрывается. См.
поле `web_app_data` в классе [Message](https://core.telegram.org/bots/api#message).

## События

Список событий, которые можно [отслеживать](#events):

| Событие              | Слушатель                                | Срабатывает, когда              |
| -------------------- | ---------------------------------------- | ------------------------------- |
| `change`             | `() => void`                             | Что-то в компоненте изменилось  |
| `change:bgColor`     | `(value: RGB) => void`                   | Свойство `bgColor` изменено     |
| `change:headerColor` | `(value: HeaderColorKey or RGB) => void` | Свойство `headerColor` изменено |

## Поддержка методов

Список методов и параметров, которые могут быть использованы
в [support checks](../components.md#methods-support): `requestWriteAccess`, `requestPhoneAccess`,
`switchInlineQuery`, `setHeaderColor`, `setBgColor` и `setHeaderColor.color`.
