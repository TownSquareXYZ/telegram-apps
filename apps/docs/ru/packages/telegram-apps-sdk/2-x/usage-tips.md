# Советы по использованию

## Избегайте использования вместе с Telegram SDK

Telegram предоставляет файл `telegram-web-app.js`. При использовании `@telegram-apps/sdk`, вы должны избегать его использования вместе с SDK, предоставляемым Telegram. Это связано с тем, что оба пакета используют один и тот же канал связи для передачи событий и вызова методов.

> [!ОСТОРОЖНО] Что, если я использую оба пакета?
> В этом случае некоторые из этих пакетов не будут получать события, отправленные из приложения Telegram, что, несомненно, приведет к ошибкам.

## Установка SDK

Перед установкой пакета важно понять, что конкретно должно быть установлено.
Это зависит от технических решений, которые вы планируете использовать.

Если ваша основная библиотека является одной из перечисленных ниже, вам следует установить пакет, соответствующий вашей основной библиотеке, вместо `@telegram-apps/sdk`:

- React: [@telegram-apps/sdk-react](../../telegram-apps-sdk-react/2-x.md)
- Vue: [@telegram-apps/sdk-vue](../../telegram-apps-sdk-vue.md)
- Svelte: [@telegram-apps/sdk-svelte](../../telegram-apps-sdk-svelte.md)

Например, если ваша основная библиотека — React, вам следует установить `@telegram-apps/sdk-react` вместо `@telegram-apps/sdk`.

Вот команда для установки пакета:

::: code-group

```bash [pnpm]
pnpm i @telegram-apps/sdk-react
```

```bash [npm]
npm i @telegram-apps/sdk-react
```

```bash [yarn]
yarn add @telegram-apps/sdk-react
```

:::

Если вашей основной библиотеки нет в списке, указанном выше, или вы предпочитаете использовать только TypeScript, установите пакет `@telegram-apps/sdk`:

::: code-group

```bash [pnpm]
pnpm i @telegram-apps/sdk
```

```bash [npm]
npm i @telegram-apps/sdk
```

```bash [yarn]
yarn add @telegram-apps/sdk
```

:::

> [!ОПАСНОСТЬ] Избегайте установки обоих пакетов
> Установка обоих пакетов, таких как `@telegram-apps/sdk` и `@telegram-apps/sdk-react`(для примера) может привести к ошибкам из-за дублирования SDK пакета, что приведет к неправильному поведению приложения.

> [!СОВЕТ] Начните с @telegram-apps/create-mini-app
> Чтобы избежать потенциальных проблем с загрузкой вашего проекта, рассмотрите возможность использования пакета [@telegram-apps/create-mini-app](../../telegram-apps-create-mini-app.md). Это позволит быстро создать для вас правильно настроенное приложение.

## Инициализация SDK

SDK предоставляет список компонентов, которые могут показаться готовыми к использованию после импорта, но это лишь частично правда.

Важно понимать, что SDK не имеет никаких побочных эффектов. Чтобы избежать различных проблем, он не выполняет операции автоматически при импорте. Вместо этого вы должны инициализировать его вручную.

По умолчанию SDK неинициализирован и не готов к использованию. Все компоненты оставляются размонтированными. Чтобы инициализировать SDK и разблокировать не только метод `mount` компонентов, но и другие не связанные с компонентами методы, вы **должны** использовать функцию `init`.

```ts
import { init } from '@telegram-apps/sdk';

init();
```

После этого вызова теперь можно безопасно монтировать любые компоненты, которые вы хотите использовать в своем приложении.

## Монтирование используемых компонентов

В предыдущем разделе мы инициализировали SDK, что позволило нам использовать компоненты.

Перед использованием определенных компонентов в вашем приложении вы должны их смонтировать. Если компоненты не смонтировать, их методы приведут к появлению ошибок. Например, следующий код вызовет ошибки:

```ts
import { init, backButton } from '@telegram-apps/sdk';

// Инициализация SDK.
init();

// Попытка отображения кнопки "Назад".
backButton.show();
// TypedError: ERR_NOT_MOUNTED: Компонент backButton 
// не был монтирован.
```

Чтобы избежать этой проблемы, смонтируйте компонент перед использованием его методов:

```ts
import { init, backButton } from '@telegram-apps/sdk';

// Инициализация SDK.
init();

// Монтирование кнопки "Назад".
backButton.mount();

// Отображение кнопки "Назад".
backButton.show();
```

> [!СОВЕТ]
> Механизм проверки монтирования гарантирует, что вы работаете с правильно инициализированным компонентом.

## Всегда проверяйте доступность

Не все методы работы с мини-приложениями Telegram были реализованы в одном выпуске. Некоторые из них, возможно, были реализованы много лет назад, в то время как другие были представлены только недавно.

Поскольку у многих пользователей разные версии приложения Telegram, вы должны проверить, доступен ли метод на их устройстве, прежде чем использовать его:

```ts
import { backButton } from '@telegram-apps/sdk';

// ... SDK уже инициализирован, а кнопка «Назад» смонтирована.
if (backButton.show.isAvailable()) {
  backButton.show();
}
```

Метод `isAvailable()` проверяет, доступна ли функция в данный момент и можно ли ее безопасно вызвать.
Он выполняет следующие проверки:

- Текущая среда - мини-приложение Telegram
- SDK инициализирован
- Метод поддерживается текущей версией мини-приложения Telegram
- Родительский компонент смонтирован

Неиспользование этого сигнала и простой вызов метода может привести к ошибкам, связанным с одной из вышеуказанных проверок.

Если вы не хотите выполнять эту проверку каждый раз и результат выполнения метода не критичен, используйте метод `ifAvailable(...args)`. Этот метод принимает те же параметры, что и
исходная функция:

```ts
import { backButton } from '@telegram-apps/sdk';

// ... SDK уже инициализирован, а кнопка «Назад» смонтирована.
backButton.show.ifAvailable();
```
